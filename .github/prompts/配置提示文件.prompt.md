---
mode: ask
---

# Day 汉化项目配置提示文件

## 🎯 项目概述
Day 汉化项目是一个用于提取和管理 RimWorld 模组翻译的自动化工具。当前正在进行重大重构，实现智能化的模板提取功能。

## 📋 当前状态 (2025年6月28日)
- **阶段**: Phase 3 - 核心提取逻辑修复
- **重点**: 修复"以英文 DefInjected 为基础"功能
- **进度**: 环境检测和交互界面已完成，正在修复核心提取逻辑

## 🔧 技术栈和工具
- **语言**: Python 3.13
- **主要依赖**: lxml, pandas, 自定义模块
- **开发环境**: VS Code + Windows PowerShell
- **项目结构**: 模块化设计，分为 core、utils、interaction 等模块

## 🎯 AI 助手任务期望

### 1. 代码分析和修复
- 分析现有代码结构和逻辑问题
- 修复 DefInjected 提取逻辑错误
- 确保代码质量和最佳实践
- 提供清晰的修复建议和实现方案

### 2. 架构设计支持
- 帮助设计模块化架构
- 提供代码重构建议
- 确保模块间的良好解耦
- 支持扩展性和维护性

### 3. 用户体验优化
- 改进命令行界面交互
- 提供清晰的状态反馈
- 优化错误处理和用户提示
- 简化复杂的操作流程

### 4. 测试和验证
- 协助创建测试用例
- 验证功能正确性
- 检查边界情况处理
- 确保各种模组兼容性

## 🔍 关键约束条件

### 技术约束
- 必须保持向后兼容性
- 遵循现有的代码风格和命名规范
- 使用相对路径和跨平台兼容的文件操作
- 优化性能，避免内存泄漏

### 业务约束
- 不能破坏现有的翻译文件格式
- 必须支持各种 RimWorld 模组结构
- 保持用户数据的完整性和安全性
- 提供清晰的操作日志和错误信息

### 用户体验约束
- 减少用户需要做的选择和输入
- 提供智能的默认选项
- 确保操作流程直观易懂
- 在出错时提供有用的帮助信息

## 📁 关键文件位置
```
day_translation/
├── main.py                     # 主程序入口
├── core/
│   ├── template_manager.py     # 模板管理核心
│   ├── smart_extractor.py      # 🔥 当前重点：智能提取器
│   ├── extractors.py           # 原有提取逻辑
│   └── generators.py           # 模板生成器
├── utils/
│   ├── environment_detector.py # ✅ 环境检测器
│   ├── conflict_resolver.py    # ⏳ 冲突解决器
│   └── config.py               # 配置管理
└── interaction/
    └── extraction_wizard.py    # ✅ 交互向导
```

## 🚨 当前紧急任务
1. **修复 DefInjected 提取逻辑** - 确保提取结构而非内容
2. **实现智能提取器类** - 整合各种提取方法
3. **完善冲突处理机制** - 处理文件覆盖和合并
4. **集成测试验证** - 确保所有功能正常工作

## 💡 AI 助手工作建议
- 优先分析和理解现有代码结构
- 分步骤实现修复，避免大规模更改
- 提供详细的代码注释和文档
- 在修改前备份关键逻辑
- 及时测试验证每个修改的效果

---
**更新时间**: 2025年6月28日
**状态**: 活跃开发中